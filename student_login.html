<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Login / Register</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body { background:#f0f2f5; font-family:'Segoe UI',sans-serif; }
.container { max-width:400px; margin-top:80px; }
.card { padding:20px; border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.1); }
a { cursor:pointer; }
</style>
</head>
<body>
<div class="container">
  <div class="card">
    <h3 class="text-center mb-4">Student Login</h3>
    <div id="loginForm">
      <div class="mb-3">
        <input type="email" id="loginEmail" class="form-control" placeholder="Email">
      </div>
      <div class="mb-3">
        <input type="password" id="loginPassword" class="form-control" placeholder="Password">
      </div>
      <button class="btn btn-primary w-100" onclick="login()">Login</button>
      <p class="mt-3 text-center">Don't have an account? <a onclick="showRegister()">Register</a></p>
    </div>

    <div id="registerForm" style="display:none;">
      <h3 class="text-center mb-4">Student Register</h3>
      <div class="mb-3">
        <input type="text" id="regName" class="form-control" placeholder="Full Name">
      </div>
      <div class="mb-3">
        <input type="email" id="regEmail" class="form-control" placeholder="Email">
      </div>
      <div class="mb-3">
        <input type="password" id="regPassword" class="form-control" placeholder="Password">
      </div>
      <button class="btn btn-success w-100" onclick="register()">Register</button>
      <p class="mt-3 text-center">Already have an account? <a onclick="showLogin()">Login</a></p>
    </div>
  </div>
</div>

<script>
// Load students from localStorage
let students = JSON.parse(localStorage.getItem('students')) || [];

// Show register
function showRegister(){
  document.getElementById('loginForm').style.display='none';
  document.getElementById('registerForm').style.display='block';
}

// Show login
function showLogin(){
  document.getElementById('registerForm').style.display='none';
  document.getElementById('loginForm').style.display='block';
}

// Register student
function register(){
  const name = document.getElementById('regName').value.trim();
  const email = document.getElementById('regEmail').value.trim();
  const password = document.getElementById('regPassword').value.trim();

  if(!name || !email || !password){
    alert('All fields are required');
    return;
  }

  if(students.some(s=>s.email===email)){
    alert('Email already exists');
    return;
  }

  const id = Date.now();
  students.push({id, name, email, password, courses:[], status:'Pending', testsTaken:[], averageScore:0});
  localStorage.setItem('students', JSON.stringify(students));
  alert('Registration successful! Wait for admin approval.');
  showLogin();
}

// Login student
function login(){
  const email = document.getElementById('loginEmail').value.trim();
  const password = document.getElementById('loginPassword').value.trim();

  const student = students.find(s=>s.email===email && s.password===password);

  if(!student){
    alert('Invalid email or password');
    return;
  }

  if(student.status==='Pending'){
    alert('Your account is pending admin approval');
    return;
  }

  if(student.status==='Suspended'){
    alert('Your account has been suspended');
    return;
  }

  localStorage.setItem('loggedInStudent', JSON.stringify(student));
  window.location.href='student_dashboard.html';
}
</script>
</body>
</html>
