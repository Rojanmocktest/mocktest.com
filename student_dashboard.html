<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rojan Mock Test - Student Dashboard</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
body { font-family: 'Segoe UI', sans-serif; background-color: #f0f2f5; margin: 0; }
.sidebar { background: linear-gradient(180deg, #1f3c88, #3a5dbf); color: #fff; min-height: 100vh; padding: 30px 15px; border-radius: 0 25px 25px 0; }
.sidebar h2 { font-size: 28px; text-align: center; margin-bottom: 40px; font-weight: bold; }
.sidebar a { display: flex; align-items: center; padding: 12px 15px; margin: 12px 0; color: #fff; font-weight: 500; border-radius: 12px; transition: all 0.3s ease; text-decoration: none; }
.sidebar a i { background-color: rgba(255,255,255,0.2); width: 36px; height: 36px; line-height: 36px; text-align: center; border-radius: 50%; margin-right: 12px; }
.sidebar a:hover { background-color: rgba(255,255,255,0.2); padding-left: 20px; }
.content { padding: 30px 25px; }
.welcome { font-size: 26px; font-weight: 600; margin-bottom: 25px; display: flex; align-items: center; gap: 10px; }
.card { border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); padding: 25px; transition: transform 0.2s; color: #fff; position: relative; }
.card i { font-size: 28px; position: absolute; top: 20px; left: 20px; opacity: 0.2; }
.card h5 { font-size: 16px; margin-top: 40px; color: rgba(255,255,255,0.9); }
.card h2 { font-size: 32px; font-weight: 700; margin-top: 10px; }
.card1 { background-color: #4e73df; }
.card2 { background-color: #1cc88a; }
.card3 { background-color: #36b9cc; }
.chart-card { padding: 25px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); background-color: #fff; margin-top: 30px; }
</style>
</head>
<body>
<div class="container-fluid">
  <div class="row">
    <!-- Sidebar -->
    <div class="col-md-3 sidebar">
      <h2>Student Panel</h2>
      <a href="#"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
      <a href="#"><i class="fas fa-book"></i> My Courses</a>
      <a href="#"><i class="fas fa-pencil-alt"></i> Mock Tests</a>
      <a href="#"><i class="fas fa-chart-line"></i> Results</a>
      <a href="student_profile.html"><i class="fas fa-user"></i> Profile</a>
      <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</a>
    </div>

    <!-- Main Content -->
    <div class="col-md-9 content">
      <div class="welcome"><i class="fas fa-user-circle"></i> <span id="studentName"></span></div>
      <div class="row g-4">
        <div class="col-md-4">
          <div class="card card1 text-center">
            <i class="fas fa-book-open"></i>
            <h5>Courses Registered</h5>
            <h2 id="coursesCount">0</h2>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card card2 text-center">
            <i class="fas fa-pencil-alt"></i>
            <h5>Tests Taken</h5>
            <h2 id="testsCount">0</h2>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card card3 text-center">
            <i class="fas fa-star"></i>
            <h5>Average Score</h5>
            <h2 id="avgScore">0%</h2>
          </div>
        </div>
      </div>
      <div class="chart-card">
        <canvas id="progressChart"></canvas>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
let currentEmail = sessionStorage.getItem('currentStudentEmail');
if(!currentEmail) window.location.href = 'student_login.html';

let students = JSON.parse(localStorage.getItem('students')) || [];
let student = students.find(s => s.email === currentEmail);

document.getElementById('studentName').innerText = student.name;
document.getElementById('coursesCount').innerText = student.courses ? student.courses.length : 0;
document.getElementById('testsCount').innerText = student.testsTaken ? student.testsTaken.length : 0;
document.getElementById('avgScore').innerText = student.averageScore ? student.averageScore+'%' : '0%';

// Dynamic chart
const ctx = document.getElementById('progressChart').getContext('2d');
new Chart(ctx, {
  type: 'line',
  data: {
    labels: student.testsTaken ? student.testsTaken.map((t,i)=>`Test ${i+1}`) : [],
    datasets: [{
      label: 'Scores',
      data: student.testsTaken ? student.testsTaken.map(t=>t.score) : [],
      backgroundColor: 'rgba(78,115,223,0.2)',
      borderColor: 'rgba(78,115,223,1)',
      borderWidth: 2,
      tension: 0.3,
      fill: true
    }]
  },
  options: {
    responsive: true,
    plugins:{ legend:{ display:false }},
    scales:{ y:{ beginAtZero:true, max:100 }}
  }
});

function logout(){
  sessionStorage.removeItem('currentStudentEmail');
  window.location.href='student_login.html';
}
</script>
</body>
</html>
