<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin - Student Management</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
body { font-family:'Segoe UI',sans-serif; background:#f0f2f5; margin:0; }
.navbar { background:#1f3c88; color:#fff; }
.navbar a { color:#fff; text-decoration:none; margin-right:15px; }
.container { margin-top:30px; }
.page-title { font-size:26px; font-weight:600; margin-bottom:20px; display:flex; align-items:center; gap:10px; }
</style>
</head>
<body>
<nav class="navbar navbar-expand-lg p-3">
  <a href="#" class="navbar-brand"><i class="fas fa-tachometer-alt"></i> Admin Panel</a>
  <a href="admin_dashboard.html">Dashboard</a>
  <a href="#" onclick="logout()">Logout</a>
</nav>

<div class="container">
  <div class="page-title"><i class="fas fa-users"></i> Manage Students</div>

  <div class="mb-3">
    <input type="text" id="searchInput" class="form-control" placeholder="Search students by name or email">
    <label><input type="checkbox" id="selectAll"> Select All</label>
    <button class="btn btn-success btn-sm" onclick="bulkApprove()">Approve Selected</button>
    <button class="btn btn-warning btn-sm" onclick="bulkSuspend()">Suspend Selected</button>
    <button class="btn btn-secondary btn-sm" onclick="bulkUnsuspend()">Unsuspend Selected</button>
    <button class="btn btn-danger btn-sm" onclick="bulkDelete()">Delete Selected</button>
  </div>

  <table class="table table-bordered table-striped">
    <thead>
      <tr>
        <th>Select</th>
        <th>Student Name</th>
        <th>Email</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="studentsTableBody"></tbody>
  </table>
</div>

<script>
// Load students from localStorage
let students = JSON.parse(localStorage.getItem('students')) || [];

// Render students
function renderStudents(filter=''){
  const tbody = document.getElementById('studentsTableBody');
  tbody.innerHTML = '';

  let filtered = students;
  if(filter){
    const f = filter.toLowerCase();
    filtered = students.filter(s => s.name.toLowerCase().includes(f) || s.email.toLowerCase().includes(f));
  }

  if(filtered.length === 0){
    tbody.innerHTML = `<tr><td colspan="5" class="text-center">No students found.</td></tr>`;
    return;
  }

  filtered.forEach(s=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td><input type="checkbox" class="studentCheckbox" data-id="${s.id}"></td>
      <td><input type="text" class="form-control" value="${s.name}" onchange="updateStudent(${s.id}, 'name', this.value)"></td>
      <td><input type="email" class="form-control" value="${s.email}" onchange="updateStudent(${s.id}, 'email', this.value)"></td>
      <td>${s.status || 'Pending'}</td>
      <td>
        <button class="btn btn-success btn-sm" onclick="approveStudent(${s.id})">Approve</button>
        <button class="btn btn-warning btn-sm" onclick="suspendStudent(${s.id})">Suspend</button>
        <button class="btn btn-secondary btn-sm" onclick="unsuspendStudent(${s.id})">Unsuspend</button>
        <button class="btn btn-danger btn-sm" onclick="deleteStudent(${s.id})">Delete</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

// Search filter
document.getElementById('searchInput').addEventListener('input', e => renderStudents(e.target.value));

// Select All checkbox
document.getElementById('selectAll').addEventListener('change', function(){
  document.querySelectorAll('.studentCheckbox').forEach(cb => cb.checked = this.checked);
});

// Update student detail
function updateStudent(id, field, value){
  const student = students.find(s=>s.id===id);
  if(student){
    student[field] = value;
    localStorage.setItem('students', JSON.stringify(students));
  }
}

// Approve / Suspend / Unsuspend single student
function approveStudent(id){ updateStatus(id,'Approved'); }
function suspendStudent(id){ updateStatus(id,'Suspended'); }
function unsuspendStudent(id){ updateStatus(id,'Approved'); }

function updateStatus(id,status){
  const student = students.find(s=>s.id===id);
  if(student){
    student.status = status;
    localStorage.setItem('students', JSON.stringify(students));
    renderStudents();
  }
}

// Delete single student
function deleteStudent(id){
  if(confirm("Delete this student?")){
    students = students.filter(s=>s.id!==id);
    localStorage.setItem('students', JSON.stringify(students));
    renderStudents();
  }
}

// Bulk actions
function getSelectedStudents(){
  return Array.from(document.querySelectorAll('.studentCheckbox:checked')).map(cb=>parseInt(cb.dataset.id));
}

function bulkApprove(){ getSelectedStudents().forEach(id=>approveStudent(id)); }
function bulkSuspend(){ getSelectedStudents().forEach(id=>suspendStudent(id)); }
function bulkUnsuspend(){ getSelectedStudents().forEach(id=>unsuspendStudent(id)); }
function bulkDelete(){
  if(confirm("Delete selected students?")){
    const selected = getSelectedStudents();
    students = students.filter(s=>!selected.includes(s.id));
    localStorage.setItem('students', JSON.stringify(students));
    renderStudents();
  }
}

// Logout
function logout(){ alert('Logged out!'); window.location.href="admin_login.html"; }

// Initial render
renderStudents();
</script>
</body>
</html>
