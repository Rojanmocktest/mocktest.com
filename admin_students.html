<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin - Student Management</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
body { font-family:'Segoe UI',sans-serif; background:#f0f2f5; margin:0; }
.navbar { background:#1f3c88; color:#fff; }
.navbar a { color:#fff; text-decoration:none; margin-right:15px; }
.container { margin-top:30px; }
.page-title { font-size:26px; font-weight:600; margin-bottom:20px; display:flex; align-items:center; gap:10px; }
.table input { width:100%; }
</style>
</head>
<body>
<nav class="navbar navbar-expand-lg p-3">
  <a href="#" class="navbar-brand"><i class="fas fa-tachometer-alt"></i> Admin Panel</a>
  <a href="admin_dashboard.html">Dashboard</a>
  <a href="#" onclick="logout()">Logout</a>
</nav>

<div class="container">
  <div class="page-title"><i class="fas fa-users"></i> Manage Students</div>

  <div class="mb-3">
    <button class="btn btn-primary btn-sm" onclick="addStudent()">Add New Student</button>
    <input type="text" id="searchInput" class="form-control mt-2" placeholder="Search by name or email">
  </div>

  <table class="table table-bordered table-striped">
    <thead>
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Email</th>
        <th>Password</th>
        <th>Courses</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="studentsTableBody"></tbody>
  </table>
</div>

<script>
// Load students
let students = JSON.parse(localStorage.getItem('students')) || [];

// Render students
function renderStudents(filter=''){
  const tbody = document.getElementById('studentsTableBody');
  tbody.innerHTML = '';
  let filtered = students;
  if(filter){
    const f = filter.toLowerCase();
    filtered = students.filter(s => s.name.toLowerCase().includes(f) || s.email.toLowerCase().includes(f));
  }
  if(filtered.length===0){
    tbody.innerHTML = `<tr><td colspan="7" class="text-center">No students found.</td></tr>`;
    return;
  }
  filtered.forEach(s=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td><input type="text" value="${s.id}" onchange="updateStudent(${s.id}, 'id', this.value)"></td>
      <td><input type="text" value="${s.name}" onchange="updateStudent(${s.id}, 'name', this.value)"></td>
      <td><input type="email" value="${s.email}" onchange="updateStudent(${s.id}, 'email', this.value)"></td>
      <td><input type="text" value="${s.password}" onchange="updateStudent(${s.id}, 'password', this.value)"></td>
      <td><input type="text" value="${s.courses ? s.courses.join(',') : ''}" onchange="updateStudent(${s.id}, 'courses', this.value.split(','))"></td>
      <td>
        <select onchange="updateStudent(${s.id}, 'status', this.value)">
          <option value="Pending" ${s.status==='Pending'?'selected':''}>Pending</option>
          <option value="Approved" ${s.status==='Approved'?'selected':''}>Approved</option>
          <option value="Suspended" ${s.status==='Suspended'?'selected':''}>Suspended</option>
        </select>
      </td>
      <td>
        <button class="btn btn-danger btn-sm" onclick="deleteStudent(${s.id})">Delete</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

// Add new student
function addStudent(){
  const newId = Date.now(); // unique ID
  const newStudent = {id:newId, name:'New Student', email:'', password:'', courses:[], status:'Pending', testsTaken:[], averageScore:0};
  students.push(newStudent);
  localStorage.setItem('students', JSON.stringify(students));
  renderStudents();
}

// Update student
function updateStudent(id, field, value){
  const student = students.find(s=>s.id===id);
  if(student){
    student[field] = value;
    localStorage.setItem('students', JSON.stringify(students));
  }
}

// Delete student
function deleteStudent(id){
  if(confirm("Delete this student?")){
    students = students.filter(s=>s.id!==id);
    localStorage.setItem('students', JSON.stringify(students));
    renderStudents();
  }
}

// Search filter
document.getElementById('searchInput').addEventListener('input', e => renderStudents(e.target.value));

// Logout
function logout(){
  alert('Logged out!');
  window.location.href='admin_login.html';
}

// Initial render
renderStudents();
</script>
</body>
</html>
